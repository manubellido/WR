(function(b){function M(a){var g=a.data;if(!a.isDefaultPrevented()){a.preventDefault();b(this).ajaxSubmit(g)}}function N(a){var g=a.target,h=b(g);if(!h.is(":submit,input:image")){g=h.closest(":submit");if(g.length===0)return;g=g[0]}var d=this;d.clk=g;if(g.type=="image")if(a.offsetX!==undefined){d.clk_x=a.offsetX;d.clk_y=a.offsetY}else if(typeof b.fn.offset=="function"){h=h.offset();d.clk_x=a.pageX-h.left;d.clk_y=a.pageY-h.top}else{d.clk_x=a.pageX-g.offsetLeft;d.clk_y=a.pageY-g.offsetTop}setTimeout(function(){d.clk=
d.clk_x=d.clk_y=null},100)}function s(){if(b.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log)window.console.log(a);else window.opera&&window.opera.postError&&window.opera.postError(a)}}var G={};G.fileapi=b("<input type='file'/>").get(0).files!==undefined;G.formdata=window.FormData!==undefined;b.fn.ajaxSubmit=function(a){function g(n){for(var A=new FormData,v=0;v<n.length;v++)A.append(n[v].name,n[v].value);if(a.extraData)for(var r in a.extraData)a.extraData.hasOwnProperty(r)&&
A.append(r,a.extraData[r]);a.data=null;n=b.extend(true,{},b.ajaxSettings,a,{contentType:false,processData:false,cache:false,type:"POST"});if(a.uploadProgress)n.xhr=function(){var c=jQuery.ajaxSettings.xhr();if(c.upload)c.upload.onprogress=function(t){var E=0,x=t.loaded||t.position,p=t.total;if(t.lengthComputable)E=Math.ceil(x/p*100);a.uploadProgress(t,x,p,E)};return c};n.data=null;var z=n.beforeSend;n.beforeSend=function(c,t){t.data=A;z&&z.call(t,c,a)};b.ajax(n)}function h(n){function A(){function i(){try{var F=
(p.contentWindow?p.contentWindow.document:p.contentDocument?p.contentDocument:p.document).readyState;s("state = "+F);F&&F.toLowerCase()=="uninitialized"&&setTimeout(i,50)}catch(H){s("Server abort: ",H," (",H.name,")");v(O);I&&clearTimeout(I);I=undefined}}var l=j.attr("target"),w=j.attr("action");r.setAttribute("target",E);d||r.setAttribute("method","POST");w!=c.url&&r.setAttribute("action",c.url);if(!c.skipEncodingOverride&&(!d||/post/i.test(d)))j.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});
if(c.timeout)I=setTimeout(function(){P=true;v(Q)},c.timeout);var B=[];try{if(c.extraData)for(var y in c.extraData)c.extraData.hasOwnProperty(y)&&B.push(b('<input type="hidden" name="'+y+'">').attr("value",c.extraData[y]).appendTo(r)[0]);if(!c.iframeTarget){x.appendTo("body");p.attachEvent?p.attachEvent("onload",v):p.addEventListener("load",v,false)}setTimeout(i,15);r.submit()}finally{r.setAttribute("action",w);l?r.setAttribute("target",l):j.removeAttr("target");b(B).remove()}}function v(i){if(!(e.aborted||
R)){try{u=p.contentWindow?p.contentWindow.document:p.contentDocument?p.contentDocument:p.document}catch(l){s("cannot access response document: ",l);i=O}if(i===Q&&e)e.abort("timeout");else if(i==O&&e)e.abort("server abort");else{if(!u||u.location.href==c.iframeSrc)if(!P)return;p.detachEvent?p.detachEvent("onload",v):p.removeEventListener("load",v,false);i="success";var w;try{if(P)throw"timeout";var B=c.dataType=="xml"||u.XMLDocument||b.isXMLDoc(u);s("isXml="+B);if(!B&&window.opera&&(u.body===null||
!u.body.innerHTML))if(--U){s("requeing onLoad callback, DOM not available");setTimeout(v,250);return}var y=u.body?u.body:u.documentElement;e.responseText=y?y.innerHTML:null;e.responseXML=u.XMLDocument?u.XMLDocument:u;if(B)c.dataType="xml";e.getResponseHeader=function(V){return{"content-type":c.dataType}[V]};if(y){e.status=Number(y.getAttribute("status"))||e.status;e.statusText=y.getAttribute("statusText")||e.statusText}var F=(c.dataType||"").toLowerCase(),H=/(json|script|text)/.test(F);if(H||c.textarea){var J=
u.getElementsByTagName("textarea")[0];if(J){e.responseText=J.value;e.status=Number(J.getAttribute("status"))||e.status;e.statusText=J.getAttribute("statusText")||e.statusText}else if(H){var K=u.getElementsByTagName("pre")[0],L=u.getElementsByTagName("body")[0];if(K)e.responseText=K.textContent?K.textContent:K.innerText;else if(L)e.responseText=L.textContent?L.textContent:L.innerText}}else if(F=="xml"&&!e.responseXML&&e.responseText)e.responseXML=W(e.responseText);try{S=X(e,F,c)}catch(Y){i="parsererror";
e.error=w=Y||i}}catch(T){s("error caught: ",T);i="error";e.error=w=T||i}if(e.aborted){s("upload aborted");i=null}if(e.status)i=e.status>=200&&e.status<300||e.status===304?"success":"error";if(i==="success"){c.success&&c.success.call(c.context,S,"success",e);t&&b.event.trigger("ajaxSuccess",[e,c])}else if(i){if(w===undefined)w=e.statusText;c.error&&c.error.call(c.context,e,i,w);t&&b.event.trigger("ajaxError",[e,c,w])}t&&b.event.trigger("ajaxComplete",[e,c]);t&&!--b.active&&b.event.trigger("ajaxStop");
c.complete&&c.complete.call(c.context,e,i);R=true;c.timeout&&clearTimeout(I);setTimeout(function(){c.iframeTarget||x.remove();e.responseXML=null},100)}}}var r=j[0],z,c,t,E,x,p,e,C,P,I;C=!!b.fn.prop;if(b(":input[name=submit],:input[id=submit]",r).length)alert('Error: Form elements must not have name or id of "submit".');else{if(n)for(z=0;z<o.length;z++){n=b(o[z]);C?n.prop("disabled",false):n.removeAttr("disabled")}c=b.extend(true,{},b.ajaxSettings,a);c.context=c.context||c;E="jqFormIO"+(new Date).getTime();
if(c.iframeTarget){x=b(c.iframeTarget);if(n=x.attr("name"))E=n;else x.attr("name",E)}else{x=b('<iframe name="'+E+'" src="'+c.iframeSrc+'" />');x.css({position:"absolute",top:"-1000px",left:"-1000px"})}p=x[0];e={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(i){var l=i==="timeout"?"timeout":"aborted";s("aborting upload... "+l);this.aborted=1;x.attr("src",c.iframeSrc);
e.error=l;c.error&&c.error.call(c.context,e,l,i);t&&b.event.trigger("ajaxError",[e,c,l]);c.complete&&c.complete.call(c.context,e,l)}};(t=c.global)&&0===b.active++&&b.event.trigger("ajaxStart");t&&b.event.trigger("ajaxSend",[e,c]);if(c.beforeSend&&c.beforeSend.call(c.context,e,c)===false)c.global&&b.active--;else if(!e.aborted){if(C=r.clk)if((n=C.name)&&!C.disabled){c.extraData=c.extraData||{};c.extraData[n]=C.value;if(C.type=="image"){c.extraData[n+".x"]=r.clk_x;c.extraData[n+".y"]=r.clk_y}}var Q=
1,O=2;C=b("meta[name=csrf-token]").attr("content");if((n=b("meta[name=csrf-param]").attr("content"))&&C){c.extraData=c.extraData||{};c.extraData[n]=C}c.forceSync?A():setTimeout(A,10);var S,u,U=50,R,W=b.parseXML||function(i,l){if(window.ActiveXObject){l=new ActiveXObject("Microsoft.XMLDOM");l.async="false";l.loadXML(i)}else l=(new DOMParser).parseFromString(i,"text/xml");return l&&l.documentElement&&l.documentElement.nodeName!="parsererror"?l:null},Z=b.parseJSON||function(i){return window.eval("("+
i+")")},X=function(i,l,w){var B=i.getResponseHeader("content-type")||"",y=l==="xml"||!l&&B.indexOf("xml")>=0;i=y?i.responseXML:i.responseText;y&&i.documentElement.nodeName==="parsererror"&&b.error&&b.error("parsererror");if(w&&w.dataFilter)i=w.dataFilter(i,l);if(typeof i==="string")if(l==="json"||!l&&B.indexOf("json")>=0)i=Z(i);else if(l==="script"||!l&&B.indexOf("javascript")>=0)b.globalEval(i);return i}}}}if(!this.length){s("ajaxSubmit: skipping submit process - no element selected");return this}var d,
f,j=this;if(typeof a=="function")a={success:a};d=this.attr("method");f=this.attr("action");if(f=(f=typeof f==="string"?b.trim(f):"")||window.location.href||"")f=(f.match(/^([^#]+)/)||[])[1];a=b.extend(true,{url:f,success:b.ajaxSettings.success,type:d||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);f={};this.trigger("form-pre-serialize",[this,a,f]);if(f.veto){s("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(a.beforeSerialize&&
a.beforeSerialize(this,a)===false){s("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var q=a.traditional;if(q===undefined)q=b.ajaxSettings.traditional;var o=[],k,m=this.formToArray(a.semantic,o);if(a.data){a.extraData=a.data;k=b.param(a.data,q)}if(a.beforeSubmit&&a.beforeSubmit(m,this,a)===false){s("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[m,this,a,f]);if(f.veto){s("ajaxSubmit: submit vetoed via form-submit-validate trigger");
return this}f=b.param(m,q);if(k)f=f?f+"&"+k:k;if(a.type.toUpperCase()=="GET"){a.url+=(a.url.indexOf("?")>=0?"&":"?")+f;a.data=null}else a.data=f;var D=[];a.resetForm&&D.push(function(){j.resetForm()});a.clearForm&&D.push(function(){j.clearForm(a.includeHidden)});if(!a.dataType&&a.target){var $=a.success||function(){};D.push(function(n){var A=a.replaceTarget?"replaceWith":"html";b(a.target)[A](n).each($,arguments)})}else a.success&&D.push(a.success);a.success=function(n,A,v){for(var r=a.context||a,
z=0,c=D.length;z<c;z++)D[z].apply(r,[n,A,v||j,j])};k=b("input:file:enabled[value]",this).length>0;f=j.attr("enctype")=="multipart/form-data"||j.attr("encoding")=="multipart/form-data";q=G.fileapi&&G.formdata;s("fileAPI :"+q);var aa=(k||f)&&!q;if(a.iframe!==false&&(a.iframe||aa))a.closeKeepAlive?b.get(a.closeKeepAlive,function(){h(m)}):h(m);else(k||f)&&q?g(m):b.ajax(a);for(k=0;k<o.length;k++)o[k]=null;this.trigger("form-submit-notify",[this,a]);return this};b.fn.ajaxForm=function(a){a=a||{};a.delegation=
a.delegation&&b.isFunction(b.fn.on);if(!a.delegation&&this.length===0){var g={s:this.selector,c:this.context};if(!b.isReady&&g.s){s("DOM not ready, queuing ajaxForm");b(function(){b(g.s,g.c).ajaxForm(a)});return this}s("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)"));return this}if(a.delegation){b(document).off("submit.form-plugin",this.selector,M).off("click.form-plugin",this.selector,N).on("submit.form-plugin",this.selector,a,M).on("click.form-plugin",this.selector,
a,N);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",a,M).bind("click.form-plugin",a,N)};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};b.fn.formToArray=function(a,g){var h=[];if(this.length===0)return h;var d=this[0],f=a?d.getElementsByTagName("*"):d.elements;if(!f)return h;var j,q,o,k,m,D;j=0;for(D=f.length;j<D;j++){m=f[j];if(o=m.name)if(a&&d.clk&&m.type=="image"){if(!m.disabled&&d.clk==m){h.push({name:o,value:b(m).val(),type:m.type});
h.push({name:o+".x",value:d.clk_x},{name:o+".y",value:d.clk_y})}}else if((k=b.fieldValue(m,true))&&k.constructor==Array){g&&g.push(m);q=0;for(m=k.length;q<m;q++)h.push({name:o,value:k[q]})}else if(G.fileapi&&m.type=="file"&&!m.disabled){g&&g.push(m);k=m.files;if(k.length)for(q=0;q<k.length;q++)h.push({name:o,value:k[q],type:m.type});else h.push({name:o,value:"",type:m.type})}else if(k!==null&&typeof k!="undefined"){g&&g.push(m);h.push({name:o,value:k,type:m.type,required:m.required})}}if(!a&&d.clk){f=
b(d.clk);j=f[0];if((o=j.name)&&!j.disabled&&j.type=="image"){h.push({name:o,value:f.val()});h.push({name:o+".x",value:d.clk_x},{name:o+".y",value:d.clk_y})}}return h};b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var g=[];this.each(function(){var h=this.name;if(h){var d=b.fieldValue(this,a);if(d&&d.constructor==Array)for(var f=0,j=d.length;f<j;f++)g.push({name:h,value:d[f]});else d!==null&&typeof d!="undefined"&&g.push({name:this.name,value:d})}});
return b.param(g)};b.fn.fieldValue=function(a){for(var g=[],h=0,d=this.length;h<d;h++){var f=b.fieldValue(this[h],a);f===null||typeof f=="undefined"||f.constructor==Array&&!f.length||(f.constructor==Array?b.merge(g,f):g.push(f))}return g};b.fieldValue=function(a,g){var h=a.name,d=a.type,f=a.tagName.toLowerCase();if(g===undefined)g=true;if(g&&(!h||a.disabled||d=="reset"||d=="button"||(d=="checkbox"||d=="radio")&&!a.checked||(d=="submit"||d=="image")&&a.form&&a.form.clk!=a||f=="select"&&a.selectedIndex==
-1))return null;if(f=="select"){var j=a.selectedIndex;if(j<0)return null;h=[];f=a.options;var q=(d=d=="select-one")?j+1:f.length;for(j=d?j:0;j<q;j++){var o=f[j];if(o.selected){var k=o.value;k||(k=o.attributes&&o.attributes.value&&!o.attributes.value.specified?o.text:o.value);if(d)return k;h.push(k)}}return h}return b(a).val()};b.fn.clearForm=function(a){return this.each(function(){b("input,select,textarea",this).clearFields(a)})};b.fn.clearFields=b.fn.clearInputs=function(a){var g=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;
return this.each(function(){var h=this.type,d=this.tagName.toLowerCase();if(g.test(h)||d=="textarea")this.value="";else if(h=="checkbox"||h=="radio")this.checked=false;else if(d=="select")this.selectedIndex=-1;else if(a)if(a===true&&/hidden/.test(h)||typeof a=="string"&&b(this).is(a))this.value=""})};b.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)this.reset()})};b.fn.enable=function(a){if(a===undefined)a=true;
return this.each(function(){this.disabled=!a})};b.fn.selected=function(a){if(a===undefined)a=true;return this.each(function(){var g=this.type;if(g=="checkbox"||g=="radio")this.checked=a;else if(this.tagName.toLowerCase()=="option"){g=b(this).parent("select");a&&g[0]&&g[0].type=="select-one"&&g.find("option").selected(false);this.selected=a}})};b.fn.ajaxSubmit.debug=false})(jQuery);
