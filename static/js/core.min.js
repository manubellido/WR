var JSON;JSON||(JSON={});
(function(){function l(b){return b<10?"0"+b:b}function o(b){p.lastIndex=0;return p.test(b)?'"'+b.replace(p,function(f){var c=r[f];return typeof c==="string"?c:"\\u"+("0000"+f.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function m(b,f){var c,d,g,k,i=h,e,a=f[b];if(a&&typeof a==="object"&&typeof a.toJSON==="function")a=a.toJSON(b);if(typeof j==="function")a=j.call(f,b,a);switch(typeof a){case "string":return o(a);case "number":return isFinite(a)?String(a):"null";case "boolean":case "null":return String(a);case "object":if(!a)return"null";
h+=n;e=[];if(Object.prototype.toString.apply(a)==="[object Array]"){k=a.length;for(c=0;c<k;c+=1)e[c]=m(c,a)||"null";g=e.length===0?"[]":h?"[\n"+h+e.join(",\n"+h)+"\n"+i+"]":"["+e.join(",")+"]";h=i;return g}if(j&&typeof j==="object"){k=j.length;for(c=0;c<k;c+=1)if(typeof j[c]==="string"){d=j[c];if(g=m(d,a))e.push(o(d)+(h?": ":":")+g)}}else for(d in a)if(Object.prototype.hasOwnProperty.call(a,d))if(g=m(d,a))e.push(o(d)+(h?": ":":")+g);g=e.length===0?"{}":h?"{\n"+h+e.join(",\n"+h)+"\n"+i+"}":"{"+e.join(",")+
"}";h=i;return g}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var q=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
p=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h,n,r={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;if(typeof JSON.stringify!=="function")JSON.stringify=function(b,f,c){var d;n=h="";if(typeof c==="number")for(d=0;d<c;d+=1)n+=" ";else if(typeof c==="string")n=c;if((j=f)&&typeof f!=="function"&&(typeof f!=="object"||typeof f.length!=="number"))throw Error("JSON.stringify");return m("",
{"":b})};if(typeof JSON.parse!=="function")JSON.parse=function(b,f){function c(g,k){var i,e,a=g[k];if(a&&typeof a==="object")for(i in a)if(Object.prototype.hasOwnProperty.call(a,i)){e=c(a,i);if(e!==undefined)a[i]=e;else delete a[i]}return f.call(g,k,a)}var d;b=String(b);q.lastIndex=0;if(q.test(b))b=b.replace(q,function(g){return"\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){d=eval("("+b+")");return typeof f==="function"?c({"":d},""):d}throw new SyntaxError("JSON.parse");}})();
(function(m,f,d){function n(b){var a={},c=/^jQuery\d+$/;d.each(b.attributes,function(o,g){if(g.specified&&!c.test(g.name))a[g.name]=g.value});return a}function h(b,a){var c=d(this);if(this.value==c.attr("placeholder")&&c.hasClass("placeholder"))if(c.data("placeholder-password")){c=c.hide().next().show().attr("id",c.removeAttr("id").data("placeholder-id"));if(b===true)return c[0].value=a;c.focus()}else{this.value="";c.removeClass("placeholder");this==f.activeElement&&this.select()}}function j(){var b,
a=d(this),c=this.id;if(this.value==""){if(this.type=="password"){if(!a.data("placeholder-textinput")){try{b=a.clone().attr({type:"text"})}catch(o){b=d("<input>").attr(d.extend(n(this),{type:"text"}))}b.removeAttr("name").data({"placeholder-password":true,"placeholder-id":c}).bind("focus.placeholder",h);a.data({"placeholder-textinput":b,"placeholder-id":c}).before(b)}a=a.removeAttr("id").hide().prev().attr("id",c).show()}a.addClass("placeholder");a[0].value=a.attr("placeholder")}else a.removeClass("placeholder")}
var i="placeholder"in f.createElement("input"),k="placeholder"in f.createElement("textarea"),e=d.fn,l=d.valHooks;if(i&&k){e=e.placeholder=function(){return this};e.input=e.textarea=true}else{e=e.placeholder=function(){this.filter((i?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":h,"blur.placeholder":j}).data("placeholder-enabled",true).trigger("blur.placeholder");return this};e.input=i;e.textarea=k;e={get:function(b){var a=d(b);return a.data("placeholder-enabled")&&
a.hasClass("placeholder")?"":b.value},set:function(b,a){var c=d(b);if(!c.data("placeholder-enabled"))return b.value=a;if(a==""){b.value=a;b!=f.activeElement&&j.call(b)}else if(c.hasClass("placeholder"))h.call(b,true,a)||(b.value=a);else b.value=a;return c}};i||(l.input=e);k||(l.textarea=e);d(function(){d(f).delegate("form","submit.placeholder",function(){var b=d(".placeholder",this).each(h);setTimeout(function(){b.each(j)},10)})});d(m).bind("beforeunload.placeholder",function(){d(".placeholder").each(function(){this.value=
""})})}})(this,document,jQuery);
var GMaps=function(n){var q=function(b){var e=this;window.context_menu={};this.div=n(b.div)[0];this.controls=[];this.overlays=[];this.markers=[];this.polylines=[];this.routes=[];this.polygons=[];this.overlay_div=this.infoWindow=null;this.zoom=b.zoom||15;var i;i=b.mapType?google.maps.MapTypeId[b.mapType.toUpperCase()]:google.maps.MapTypeId.ROADMAP;var p=new google.maps.LatLng(b.lat,b.lng);delete b.lat;delete b.lng;delete b.mapType;i=n.extend({zoom:this.zoom,center:p,mapTypeId:i},b);this.map=new google.maps.Map(this.div,
i);var m=function(a,c){var d="",g=window.context_menu[a];for(var f in g)if(g.hasOwnProperty(f))d+='<li><a id="'+a+"_"+f+'" href="#">'+g[f].title+"</a></li>";f=n("#gmaps_context_menu");f.html(d);f.undelegate();f.delegate("li a","click",function(h){h.preventDefault();g[n(this).attr("id").replace(a+"_","")].action.call(e,c);e.hideContextMenu()});d=n(e.div).offset().left+c.pixel.x-15;var j=n(e.div).offset().top+c.pixel.y-15;f.css({left:d,top:j}).fadeIn(200)},o=function(a,c){if(a==="marker"){c.pixel={};
var d=new google.maps.OverlayView;d.setMap(e.map);d.draw=function(){var g=d.getProjection(),f=c.marker.getPosition();c.pixel=g.fromLatLngToContainerPixel(f);m(a,c)}}else m(a,c)};this.setContextMenu=function(a){window.context_menu[a.control]={};for(var c in a.options)if(a.options.hasOwnProperty(c)){var d=a.options[c];window.context_menu[a.control][d.name]={title:d.title,action:d.action}}n("body").append('<ul id="gmaps_context_menu" style="position:absolute;display:none;min-width:100px;background:white;list-style:none;padding:8px;box-shadow:2px 2px 6px #ccc"></ul>');
n("#gmaps_context_menu").mouseleave(function(){n(this).delay(100).fadeOut(200)})};this.hideContextMenu=function(){n("#gmaps_context_menu").fadeOut(200)};google.maps.event.addListener(this.map,"bounds_changed",function(a){b.bounds_changed&&b.bounds_changed(a);e.hideContextMenu()});google.maps.event.addListener(this.map,"center_changed",function(a){b.center_changed&&b.center_changed(a);e.hideContextMenu()});google.maps.event.addListener(this.map,"click",function(a){b.click&&b.click(a);e.hideContextMenu()});
google.maps.event.addListener(this.map,"dblclick",function(a){b.dblclick&&b.dblclick(a);e.hideContextMenu()});google.maps.event.addListener(this.map,"drag",function(a){b.drag&&b.drag(a);e.hideContextMenu()});google.maps.event.addListener(this.map,"dragend",function(a){b.dragend&&b.dragend(a);e.hideContextMenu()});google.maps.event.addListener(this.map,"dragstart",function(a){b.dragstart&&b.dragstart(a);e.hideContextMenu()});google.maps.event.addListener(this.map,"idle",function(a){b.idle&&b.idle(a);
e.hideContextMenu()});google.maps.event.addListener(this.map,"maptypeid_changed",function(a){b.maptypeid_changed&&b.maptypeid_changed(a);e.hideContextMenu()});google.maps.event.addListener(this.map,"mousemove",function(a){b.mousemove&&b.mousemove(a)});google.maps.event.addListener(this.map,"mouseout",function(a){b.mouseout&&b.mouseout(a)});google.maps.event.addListener(this.map,"mouseover",function(a){b.mouseover&&b.mouseover(a)});google.maps.event.addListener(this.map,"projection_changed",function(a){b.projection_changed&&
b.projection_changed(a);e.hideContextMenu()});google.maps.event.addListener(this.map,"resize",function(a){b.resize&&b.resize(a);e.hideContextMenu()});google.maps.event.addListener(this.map,"rightclick",function(a){b.rightclick&&b.rightclick(a);o("map",a)});google.maps.event.addListener(this.map,"tilesloaded",function(a){b.tilesloaded&&b.tilesloaded(a);e.hideContextMenu()});google.maps.event.addListener(this.map,"zoom_changed",function(a){b.zoom_changed&&b.zoom_changed(a);e.hideContextMenu()});this.setCenter=
function(a,c,d){this.map.panTo(new google.maps.LatLng(a,c));d&&d()};this.getCenter=function(){return this.map.getCenter()};this.getDiv=function(){return this.div};this.setZoom=function(a){this.map.setZoom(a)};this.zoomIn=function(a){this.map.setZoom(this.map.getZoom()+a)};this.zoomOut=function(a){this.map.setZoom(this.map.getZoom()-a)};this.createControl=function(a){a.style.cursor="pointer";a.style.fontFamily="Arial, sans-serif";a.style.fontSize="13px";a.style.boxShadow="rgba(0, 0, 0, 0.398438) 0px 2px 4px";
var c=n("<div></div>");c.css(a.style);c.text(a.text);c=c[0];for(var d in a.events)google.maps.event.addDomListener(c,d,function(){a.events[d].apply(this,[this])});c.index=1;return c};this.addControl=function(a){var c=google.maps.ControlPosition[a.position.toUpperCase()];delete a.position;a=this.createControl(a);this.controls.push(a);this.map.controls[c].push(a);return a};this.createMarker=function(a){if(a.lat&&a.lng){var c=this,d=a.details,g=a.fences,f=a.outside,j={position:new google.maps.LatLng(a.lat,
a.lng),map:null};delete a.lat;delete a.lng;delete a.fences;delete a.outside;j=n.extend(j,a);var h=new google.maps.Marker(j);h.fences=g;if(a.infoWindow){h.infoWindow=new google.maps.InfoWindow(a.infoWindow);a.infoWindow.closeclick&&google.maps.event.addListener(h.infoWindow,"closeclick",function(){a.infoWindow.closeclick()});a.infoWindow.content_changed&&google.maps.event.addListener(h.infoWindow,"content_changed",function(){a.infoWindow.content_changed()});a.infoWindow.domready&&google.maps.event.addListener(h.infoWindow,
"domready",function(){a.infoWindow.domready()});a.infoWindow.position_changed&&google.maps.event.addListener(h.infoWindow,"position_changed",function(){a.infoWindow.position_changed()});a.infoWindow.zindex_changed&&google.maps.event.addListener(h.infoWindow,"zindex_changed",function(){a.infoWindow.zindex_changed()})}google.maps.event.addListener(h,"click",function(){this.details=d;a.click&&a.click.apply(this,[this]);if(h.infoWindow){c.hideInfoWindows();h.infoWindow.open(c.map,h)}});a.drag&&google.maps.event.addListener(h,
"drag",function(){a.drag(this)});if(a.dragend||h.fences)google.maps.event.addListener(h,"dragend",function(){a.dragend&&a.dragend(this);h.fences&&c.checkMarkerGeofence(h,function(r,s){f(r,s)})});a.dragstart&&google.maps.event.addListener(h,"dragstart",function(){a.dragstart(this)});a.mouseout&&google.maps.event.addListener(h,"mouseout",function(){a.mouseout(this)});a.mouseover&&google.maps.event.addListener(h,"mouseover",function(){a.mouseover(this)});a.mouseup&&google.maps.event.addListener(h,"mouseup",
function(){a.mouseup(this)});a.position_changed&&google.maps.event.addListener(h,"position_changed",function(){a.position_changed(this)});return h}else throw"No latitude or longitude defined";};this.addMarker=function(a){if(a.lat&&a.lng){a=this.createMarker(a);a.setMap(this.map);this.markers.push(a);return a}else throw"No latitude or longitude defined";};this.addMarkers=function(a){for(var c=0,d;d=a[c];c++)this.addMarker(d);return this.markers};this.hideInfoWindows=function(){for(var a=0,c;c=this.markers[a];a++)c.infoWindow&&
c.infoWindow.close()};this.removeMarkers=function(){for(var a=0,c;c=this.markers[a];a++)c.setMap(null);this.markers=[]};this.drawOverlay=function(a){var c=new google.maps.OverlayView;c.setMap(e.map);c.onAdd=function(){var d=document.createElement("div");d.style.borderStyle="none";d.style.borderWidth="0px";d.style.position="absolute";d.innerHTML=a.content;e.overlay_div=d;var g=this.getPanes();if(!a.layer)a.layer="overlayLayer";g[a.layer].appendChild(d)};c.draw=function(){var d=this.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(a.lat,
a.lng));a.horizontalOffset=a.horizontalOffset||0;a.verticalOffset=a.verticalOffset||0;var g=e.overlay_div,f=g.children;switch(a.verticalAlign){case "top":g.style.top=d.y-n(f).height()+a.verticalOffset+"px";break;default:case "middle":g.style.top=d.y-n(f).height()/2+a.verticalOffset+"px";break;case "bottom":g.style.top=d.y+a.verticalOffset+"px";break}switch(a.horizontalAlign){case "left":g.style.left=d.x-n(f).width()+a.horizontalOffset+"px";break;default:case "center":g.style.left=d.x-n(f).width()/
2+a.horizontalOffset+"px";break;case "right":g.style.left=d.x+a.horizontalOffset+"px";break}};c.onRemove=function(){e.overlay_div.parentNode.removeChild(e.overlay_div);e.overlay_div=null};e.overlays.push(c);return c};this.removeOverlay=function(a){a.setMap(null)};this.removeOverlays=function(){for(var a=0,c;c=e.overlays[a];a++)c.setMap(null);e.overlays=[]};this.drawPolyline=function(a){var c=[],d=a.path;if(d.length)if(d[0][0]===undefined)c=d;else for(var g=0,f;f=d[g];g++)c.push(new google.maps.LatLng(f[0],
f[1]));c=new google.maps.Polyline({map:this.map,path:c,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight});a.click&&google.maps.event.addListener(c,"click",function(j){a.click(j)});a.dblclick&&google.maps.event.addListener(c,"dblclick",function(j){a.dblclick(j)});a.mousedown&&google.maps.event.addListener(c,"mousedown",function(j){a.mousedown(j)});a.mousemove&&google.maps.event.addListener(c,"mousemove",function(j){a.mousemove(j)});a.mouseout&&google.maps.event.addListener(c,
"mouseout",function(j){a.mouseout(j)});a.mouseover&&google.maps.event.addListener(c,"mouseover",function(j){a.mouseover(j)});a.mouseup&&google.maps.event.addListener(c,"mouseup",function(j){a.mouseup(j)});a.rightclick&&google.maps.event.addListener(c,"rightclick",function(j){a.rightclick(j)});this.polylines.push(c);return c};this.drawCircle=function(a){a=n.extend({map:this.map,center:new google.maps.LatLng(a.lat,a.lng)},a);delete a.lat;delete a.lng;var c=new google.maps.Circle(a);google.maps.event.addListener(c,
"click",function(d){a.click&&a.click(d)});google.maps.event.addListener(c,"dblclick",function(d){a.dblclick&&a.dblclick(d)});google.maps.event.addListener(c,"mousedown",function(d){a.mousedown&&a.mousedown(d)});google.maps.event.addListener(c,"mousemove",function(d){a.mousemove&&a.mousemove(d)});google.maps.event.addListener(c,"mouseout",function(d){a.mouseout&&a.mouseout(d)});google.maps.event.addListener(c,"mouseover",function(d){a.mouseover&&a.mouseover(d)});google.maps.event.addListener(c,"mouseup",
function(d){a.mouseup&&a.mouseup(d)});google.maps.event.addListener(c,"rightclick",function(d){a.rightclick&&a.rightclick(d)});return c};this.drawPolygon=function(a){a=n.extend({map:this.map},a);var c=new google.maps.Polygon(a);google.maps.event.addListener(c,"click",function(d){a.click&&a.click(d)});google.maps.event.addListener(c,"dblclick",function(d){a.dblclick&&a.dblclick(d)});google.maps.event.addListener(c,"mousedown",function(d){a.mousedown&&a.mousedown(d)});google.maps.event.addListener(c,
"mousemove",function(d){a.mousemove&&a.mousemove(d)});google.maps.event.addListener(c,"mouseout",function(d){a.mouseout&&a.mouseout(d)});google.maps.event.addListener(c,"mouseover",function(d){a.mouseover&&a.mouseover(d)});google.maps.event.addListener(c,"mouseup",function(d){a.mouseup&&a.mouseup(d)});google.maps.event.addListener(c,"rightclick",function(d){a.rightclick&&a.rightclick(d)});this.polygons.push(c);return c};var k,l;this.getRoutes=function(a){switch(a.travelMode){case "bicycling":k=google.maps.TravelMode.BICYCLING;
break;case "driving":k=google.maps.TravelMode.DRIVING;break;default:k=google.maps.TravelMode.WALKING;break}l=a.unitSystem==="imperial"?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC;var c=n.extend({avoidHighways:true,avoidTolls:true,optimizeWaypoints:true,waypoints:[]},a);c.origin=new google.maps.LatLng(a.origin[0],a.origin[1]);c.destination=new google.maps.LatLng(a.destination[0],a.destination[1]);c.travelMode=k;c.unitSystem=l;delete c.callback;var d=this;(new google.maps.DirectionsService).route(c,
function(g,f){if(f===google.maps.DirectionsStatus.OK)for(var j in g.routes)g.routes.hasOwnProperty(j)&&d.routes.push(g.routes[j]);a.callback&&a.callback(d.routes)})};this.drawRoute=function(a){var c=this;this.getRoutes({origin:a.origin,destination:a.destination,travelMode:a.travelMode,callback:function(d){if(d.length>0){c.drawPolyline({path:d[d.length-1].overview_path,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight});a.callback&&a.callback(d[d.length-1])}}})};this.travelRoute=
function(a){if(a.origin&&a.destination)this.getRoutes({origin:a.origin,destination:a.destination,travelMode:a.travelMode,callback:function(f){if(f.length>0&&a.step){f=f[f.length-1];if(f.legs.length>0){f=f.legs[0].steps;for(var j=0,h;h=f[j];j++){h.step_number=j;a.step(h)}}}}});else if(a.route)if(a.route.legs.length>0)for(var c=a.route.legs[0].steps,d=0,g;g=c[d];d++){g.step_number=d;a.step(g)}};this.drawSteppedRoute=function(a){if(a.origin&&a.destination)this.getRoutes({origin:a.origin,destination:a.destination,
travelMode:a.travelMode,callback:function(f){if(f.length>0&&a.step){f=f[f.length-1];if(f.legs.length>0){f=f.legs[0].steps;for(var j=0,h;h=f[j];j++){h.step_number=j;e.drawPolyline({path:h.path,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight});a.step(h)}}}}});else if(a.route)if(a.route.legs.length>0)for(var c=a.route.legs[0].steps,d=0,g;g=c[d];d++){g.step_number=d;e.drawPolyline({path:g.path,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight});
a.step(g)}};this.checkGeofence=function(a,c,d){return d.containsLatLng(new google.maps.LatLng(a,c))};this.checkMarkerGeofence=function(a,c){if(a.fences)for(var d=0,g;g=a.fences[d];d++){var f=a.getPosition();e.checkGeofence(f.lat(),f.lng(),g)||c(a,g)}}};q.Route=function(b){this.map=b.map;this.route=b.route;this.step_count=0;this.steps=this.route.legs[0].steps;this.steps_length=this.steps.length;this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray,strokeColor:b.strokeColor,strokeOpacity:b.strokeOpacity,
strokeWeight:b.strokeWeight}).getPath();this.back=function(){if(this.step_count>0){this.step_count--;var e=this.route.legs[0].steps[this.step_count].path;for(var i in e)e.hasOwnProperty(i)&&this.polyline.pop()}};this.forward=function(){if(this.step_count<this.steps_length){var e=this.route.legs[0].steps[this.step_count].path;for(var i in e)e.hasOwnProperty(i)&&this.polyline.push(e[i]);this.step_count++}}};q.geolocate=function(b){if(navigator.geolocation)navigator.geolocation.getCurrentPosition(function(e){b.success(e);
b.always&&b.always()},function(e){b.error(e);b.always&&b.always()},b.options);else{b.not_supported();b.always&&b.always()}};q.geocode=function(b){this.geocoder=new google.maps.Geocoder;var e=b.callback;if(b.lat&&b.lng)b.latLng=new google.maps.LatLng(b.lat,b.lng);delete b.lat;delete b.lng;delete b.callback;this.geocoder.geocode(b,function(i,p){e(i,p)})};q.staticMapURL=function(b){function e(a,c){if(a[0]==="#"){a=a.replace("#","0x");if(c){c=parseFloat(c);c=Math.min(1,Math.max(c,0));if(c===0)return"0x00000000";
c=(c*255).toString(16);if(c.length===1)c+=c;a=a.slice(0,8)+c}}return a}var i=[],p="https://maps.googleapis.com/maps/api/staticmap";if(b.url){p=b.url;delete b.url}p+="?";var m=b.markers;delete b.markers;if(!m&&b.marker){m=[b.marker];delete b.marker}var o=b.polyline;delete b.polyline;if(b.center){i.push("center="+b.center);delete b.center}else if(b.address){i.push("center="+b.address);delete b.address}else if(b.lat){i.push(["center=",b.lat,",",b.lng].join(""));delete b.lat;delete b.lng}else if(b.visible){var k=
encodeURI(b.visible.join("|"));i.push("visible="+k)}if(k=b.size){if(k.join)k=k.join("x");delete b.size}else k="630x300";i.push("size="+k);if(!b.zoom)b.zoom=15;k=b.hasOwnProperty("sensor")?!!b.sensor:true;delete b.sensor;i.push("sensor="+k);for(var l in b)b.hasOwnProperty(l)&&i.push(l+"="+b[l]);if(m)for(k=0;b=m[k];k++){l=[];if(b.size&&b.size!=="normal")l.push("size:"+b.size);else b.icon&&l.push("icon:"+encodeURI(b.icon));b.color&&l.push("color:"+b.color.replace("#","0x"));b.label&&l.push("label:"+
b.label[0].toUpperCase());b=b.address?b.address:b.lat+","+b.lng;if(l.length||k===0){l.push(b);l=l.join("|");i.push("markers="+encodeURI(l))}else{l=i.pop()+encodeURI("|"+b);i.push(l)}}if(o){b=o;o=[];b.strokeWeight&&o.push("weight:"+parseInt(b.strokeWeight,10));if(b.strokeColor){m=e(b.strokeColor,b.strokeOpacity);o.push("color:"+m)}if(b.fillColor){m=e(b.fillColor,b.fillOpacity);o.push("fillcolor:"+m)}m=b.path;if(m.join)for(b=0;l=m[b];b++)o.push(l.join(","));else o.push("enc:"+m);o=o.join("|");i.push("path="+
encodeURI(o))}i=i.join("&");return p+i};if(!google.maps.Polygon.prototype.getBounds)google.maps.Polygon.prototype.getBounds=function(){for(var b=new google.maps.LatLngBounds,e=this.getPaths(),i,p=0;p<e.getLength();p++){i=e.getAt(p);for(var m=0;m<i.getLength();m++)b.extend(i.getAt(m))}return b};google.maps.Polygon.prototype.containsLatLng=function(b){var e=this.getBounds();if(e!==null&&!e.contains(b))return false;e=false;for(var i=this.getPaths().getLength(),p=0;p<i;p++)for(var m=this.getPaths().getAt(p),
o=m.getLength(),k=o-1,l=0;l<o;l++){var a=m.getAt(l);k=m.getAt(k);if(a.lng()<b.lng()&&k.lng()>=b.lng()||k.lng()<b.lng()&&a.lng()>=b.lng())if(a.lat()+(b.lng()-a.lng())/(k.lng()-a.lng())*(k.lat()-a.lat())<b.lat())e=!e;k=l}return e};google.maps.LatLngBounds.prototype.containsLatLng=function(b){return this.contains(b)};google.maps.Marker.prototype.setFences=function(b){this.fences=b};google.maps.Marker.prototype.addFence=function(b){this.fences.push(b)};return q}(jQuery);
var KEY_ENTER=13,KEY_TAB=9;window.fbAsyncInit=function(){FB.init({appId:FACEBOOK_APP_ID,status:true,cookie:true})};$(document).ready(function(){$("#welcomeCarousel").carousel({interval:5E3});columnize();bindActions();calcDistances();bindWidgets();bindShare();bindCitySearch();bindLoadMore();bindRemix();bindAccountSettings();$("#load-more").css("display","block").show()});function storageSet(a,b){if(window.localStorage){localStorage.setItem(a,b);return b}}
function storageGet(a){if(window.localStorage)return localStorage.getItem(a)}
function ColSet(a,b){this.PADDING=36;this.$section=$(a).css("position","relative");this.getLimits();var c=this,e,f,d,h=navigator.appName=="Microsoft Internet Explorer",g=function(){if(h){window.onresize=null;c.update(b);setTimeout(function(){window.onresize=g},10);return false}clearTimeout(e);clearTimeout(f);clearTimeout(d);e=setTimeout(function(){c.update(b);f=setTimeout(function(){c.update(b);d=setTimeout(function(){c.update(b)},300)},300)},100)};g();window.onresize=g}
ColSet.prototype.getLimits=function(){var a=this.$section.attr("data-columns").split(/\s*,\s*/),b=parseInt(a[0],10);a=parseInt(a[1],10);if(isNaN(a)||a<b)a=b;if(isNaN(b))console.error([b,a]);else{this.min=b;this.max=a}};ColSet.prototype.getColWidth=function(){var a=this.$section.width(),b=Math.ceil(a/this.max),c=Math.floor(a/b);if(c<this.min){b-=1;c=Math.floor(a/b)}this.colWidth=c;this.numCols=b};ColSet.prototype.update=function(a){a?this.sorted_update():this.masonry_update()};
ColSet.prototype.sorted_update=function(){var a=this.$section.children();a=_.toArray(a);var b=a.length;this.getColWidth();var c=this.colWidth,e=this.numCols,f=0,d=[],h,g,i,j,k;for(h=0;h<b;h+=e){for(g=f=0;g<e;g+=1){i=a[h+g];if(!i)break;i=$(i);j=i.find("[data-ratio-hw]");k=parseInt(j.attr("data-ratio-hw"),10)/100;j.css({width:c-this.PADDING+"px",height:k*(c-this.PADDING)+"px"});i.css({top:(d[g]||0)+"px",left:f+"px",width:c+"px",visibility:"visible",display:"block"});f+=c;d[g]=(d[g]||0)+i.height()}this.$section.height(_.max(d))}this.y=
d;this.$section.height(_.max(d))};
ColSet.prototype.masonry_update=function(){var a=this.$section,b=a.children();b=_.toArray(b);this.getColWidth();var c=this.colWidth,e=this.numCols,f=this.PADDING,d,g,h,i,j=[];for(d=0;d<e;d++)j[d]=0;_.each(b,function(k){g=$(k);d=_.indexOf(j,_.min(j));h=g.find("[data-ratio-hw]");i=parseInt(h.attr("data-ratio-hw"),10)/100;h.css({width:c-f+"px",height:i*(c-f)+"px"});g.css({top:(j[d]||0)+"px",left:d*c+"px",width:c+"px",visibility:"visible",display:"block"});j[d]=(j[d]||0)+g.height();a.height(_.max(j))});
this.y=j};ColSet.prototype.append=function(a){var b=this.y,c=this.colWidth,e=_.indexOf(b,_.min(b));a=$(a);var f=a.find("[data-ratio-hw]"),d=parseInt(f.attr("data-ratio-hw"),10)/100;f.css("height",d*(c-this.PADDING)+"px");a.css({top:(b[e]||0)+"px",left:e*c+"px",width:c+"px",visibility:"visible",display:"block"});this.$section.append(a);b[e]=(b[e]||0)+a.height();this.$section.height(_.max(b));this.y=b};function columnize(){$("[data-columns]").each(function(a,b){$(b).data("colset",new ColSet(b))})}
function bindWidgets(){$("[placeholder]").placeholder();$(".no-touch .btn-tooltip").tooltip();$(".dropdown-toggle").dropdown();$(".styled-checks input").on("change",function(){$(this).parents("label").toggleClass("checked",$(this).is(":checked"))})}
function bindShare(){$(document).on("click",".social-sharing .btn",function(a){a.preventDefault();var b=$(this);a=b.parents(".social-sharing");b=b.attr("data-type");var c=a.attr("data-url")||window.location.href;a=a.attr("data-message")||"";share(b,c,a)});$(document).on("click","[data-embed]",function(a){a.preventDefault();a=$(this).attr("data-url")||window.location.href+"embedform/";window.open(a,"embedform","width=600, height=400")})}
function share(a,b,c){({facebook:facebookShare,twitter:twitterShare})[a](b,c)}
function facebookShare(a){a=["app_id="+FACEBOOK_APP_ID,"link="+a,"redirect_uri="+a,"display=popup"];var b=$('meta[property="og:image"]').attr("content");b&&a.push("picture="+b);if(b=$('meta[property="og:title"]').attr("content")){b=encodeURIComponent(b);a.push("name="+b)}if(b=$('meta[property="og:caption"]').attr("content")){b=encodeURIComponent(b);a.push("caption="+b)}if(b=$('meta[property="og:description"]').attr("content")){b=encodeURIComponent(b);a.push("description="+b)}a="https://www.facebook.com/dialog/feed?"+
a.join("&");window.open(a,"facebook_share","width=600, height=300")}function twitterShare(a,b){var c=140-a.length-9-3;if(b.length>c){b=b.substr(0,c-2);b+="\u2026"}b=[b,a,"#worldrat"].join(" ");c="http://twitter.com/intent/tweet?text="+encodeURIComponent(b);window.open(c,"twitter_share","width=600, height=400")}
function bindCitySearch(){var a=$(".city-search");if(a.length!==0){var b=function(){$.trim(a.val())||a.val(a.attr("data-default")||"")},c=new google.maps.places.Autocomplete(a[0],{types:["(cities)"]});google.maps.event.addListener(c,"place_changed",function(){a.blur();var e=c.getPlace();if(!e||!e.address_components){b();return false}var f=a.attr("data-url");if(!f){b();return false}e={address_components:e.address_components,section:a.attr("data-category")||"home"};$("[data-columns]").addClass("wait");
$.ajax({type:"POST",url:f,data:JSON.stringify(e),success:function(d){if(d&&d.link)window.location.href=d.link.href},error:function(d,h,g){$("[data-columns]").removeClass("wait");console.error(g)},dataType:"json"})});a.on("mousedown",function(e){e.preventDefault();e.stopPropagation();a[0].select();b();return false});a.on("blur",function(){b()});a.on("keydown",function(e){var f=$.trim(a.val());if(e.which==KEY_ENTER&&f.search(/world/)!==-1){e.preventDefault();e.stopPropagation();e=a.attr("data-category");
window.location.href=e?"/routes/categories/"+e:"/";return false}});$(document).on("mousedown",function(){b()})}}
function bindLoadMore(){$("#load-more").on("click",function(){var a=$(this).addClass("wait").prop("disabled",true),b=a.attr("data-target-href"),c=a.attr("data-page"),e=a.attr("data-page-type"),f=a.attr("data-category");$.ajax({type:"POST",url:b,data:{page:c,page_type:e,category_type:f}}).done(function(d){a.removeClass("wait");if(!d||d.hide_button){a.addClass("nomore").text(a.attr("data-nomore"));if(!d)return}else a.prop("disabled",false);var h=d.raw_html;if(h){var g=$("[data-columns]").eq(0).data("colset");
h=h.replace(/\n+/gi,"").replace(/\s+/gi," ");$(h).filter(".flow-item").each(function(){g.append(this)})}a.attr("data-page",d.page)})})}function makeScrollTo(a){return function(){var b=$("#r-"+a),c=b.offset();c&&$("html, body").animate({scrollTop:c.top},function(){highlight(b.find("div").eq(0))}).focus()}}
function insertRealMap(a,b){var c=new GMaps({div:a,zoom:13,scrollwheel:false}),e=c.map,f,d=new google.maps.LatLngBounds,h=[];_.each(b,function(g){c.addMarker({lat:g.lat,lng:g.lng,title:g.title,click:makeScrollTo(g.id)});f=new google.maps.LatLng(g.lat,g.lng);d.extend(f);h.push([g.lat,g.lng])});e.setCenter(d.getCenter());e.fitBounds(d);c.drawPolyline({path:h,strokeColor:"#1b60e8",strokeOpacity:0.4,strokeWeight:6});$("#expand-map").click(function(g){g.preventDefault();g.stopPropagation();g=$(this);var i=
g.hasClass("expanded")?300:500;g.toggleClass("expanded");c.map.setOptions({disableDefaultUI:true});$("#map").animate({height:i+"px"},300,function(){google.maps.event.trigger(c.map,"resize");c.map.setOptions({disableDefaultUI:false})});return false});return c}function insertStaticMap(a,b){$("#expand-map").hide();if(b.length!==0){var c=$(a),e=GMaps.staticMapURL({size:[c.width(),c.height()],lat:b[0].lat,lng:b[0].lng,markers:b});$("<img/>").attr("src",e).appendTo(c);return c[0]}}
function easeInOut(a,b,c,e,f){b=b-a;return Math.ceil(a+Math.pow(1/c*e,f)*b)}function doBGFade(a,b,c,e,f,d,h){a.bgFadeInt&&window.clearInterval(a.bgFadeInt);var g=0;a.bgFadeInt=window.setInterval(function(){a.css("backgroundColor","rgb("+easeInOut(b[0],c[0],f,g,h)+","+easeInOut(b[1],c[1],f,g,h)+","+easeInOut(b[2],c[2],f,g,h)+")");g++;if(g>f){a.css("backgroundColor",e);window.clearInterval(a.bgFadeInt)}},d)}function highlight(a){var b=[255,255,255];doBGFade(a,[241,221,104],b,b,40,20,4)}
function bindRemix(){var a=$("#circuit-remix");if(a.length){a.modal({show:false});$("section").on("click","[data-remix]",function(b){b.preventDefault();b.stopPropagation();b=$(this);a.find("input[name=name]").val(b.attr("data-name"));a.find("select[name=category]").val(b.attr("data-cat"));a.find("#remix-route-name").html(b.attr("data-name"));a.attr("action",b.attr("data-remix"));a.modal("show")})}}function bindActions(){bindToggleButtons();bindRadioButtons()}
function bindToggleButtons(){$("section").on("click","[data-toggle-class]",function(a){a.preventDefault();a.stopPropagation();a=$(this);var b=a.attr("data-toggle-class"),c=a.hasClass(b),e=a.attr("data-msg");if(e&&!confirm(e))return false;var f=c?"off":"on";c=a.attr("data-title-"+f);e=a.attr("data-text-"+f);f=a.attr("data-url-"+f);a.toggleClass(b);if(c)a.attr("data-original-title")?a.attr("data-original-title",c):a.attr("title",c);e&&a.find("span").text(e);if(!f)return false;$.ajax({type:"POST",url:f,
success:function(d){if(d&&d.link)window.location.href=d.link.href},error:function(d,h,g){console.error(g)},dataType:"json"});return false})}
function bindRadioButtons(){$("section").on("click","[data-val]",function(a){a.preventDefault();a.stopPropagation();var b=$(this),c=b.parents("[data-radio]");a=c.attr("data-radio");var e=c.attr("data-name"),f=b.attr("data-val");b=b.attr("data-val-class");if(c.attr("data-val")==f){f=0;b=""}c.attr("data-val",f);c[0].className=b;if(!a)return false;c={};c[e]=f;$.ajax({type:"POST",url:a,data:c,success:function(d){if(d&&d.link)window.location.href=d.link.href},error:function(d,h,g){console.error(g)},dataType:"json"});
return false})}function calcDistances(){var a=$("[data-coords]");if(!(a.length===0||typeof GMaps==="undefined")){var b=function(){a.hide()};GMaps.geolocate({success:function(c){var e=[c.coords.latitude,c.coords.longitude];a.each(function(){var f=$(this),d=f.attr("data-coords").split(/\s*,\s*/),h=parseFloat(d[0],10);d=parseFloat(d[1],10);if(!(isNaN(h)||isNaN(d))){h=getDistance(e,[h,d]);f.find("span").text(h)}})},error:b,not_supported:b,options:{maximumAge:3E5}})}}
function toggle_more_cats_sidebar(){var a=$("#more-cats-controller a");a.click(function(){a.toggleClass("show");$("#more-cats").collapse("toggle")})}
function humanDate(a){var b=new Date;a=new Date(a);var c=b.getYear()-a.getYear();if(c>0){if(c===1)return c+" year ago.";return c+" years ago."}c=b.getMonth()-a.getMonth();if(c>0){if(c===1)return c+" month ago.";return c+" months ago."}c=b.getDay()-a.getDay();if(c>0){if(c===1)return c+"day ago.";return c+" days ago."}b=b.getMinutes()-a.getMinutes();if(b>0){if(b===1)return b+" minute ago.";return b+" minutes ago."}return"Just now"}var PI_180=Math.PI/180;
function getDistance(a,b){var c=a[0],e=b[0],f=(e-c)*PI_180,d=(b[1]-a[1])*PI_180;c=Math.sin(f/2)*Math.sin(f/2)+Math.cos(c*PI_180)*Math.cos(e*PI_180)*Math.sin(d/2)*Math.sin(d/2);c=6371*2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));if(c<1)return Math.round(c*1E3)+" m";return Math.round(c*10)/10+" Km"}function setLastEmailIndex(){var a=$(".user-email").last().attr("data-index");$("ul.emails").attr("data-index",a)}
function bindAccountSettings(){setLastEmailIndex();$("#append-email").on("click",function(){var a=$(this).attr("data-target-href"),b=$("#email-candidate").val();$.ajax({type:"POST",url:a,data:{email:b}}).done(function(c){if(c.status=="OK"){var e=(parseInt($(".user-email").last().attr("data-index"))+1).toString();$("ul.emails").append('<li data-index="'+e+'"><span class="user-email not-verified"</span><span class="delete-email" data-index="'+e+'">X</span></li>');$("#notifications").html('<p class="alert alert-success">Se te ha enviado un correo para verificar la direcci\u00f3n</p>')}c.status==
"error"&&$("#notifications").html('<p class="alert alert-error">'+c.message+"</p>");setLastEmailIndex()})});$(".delete-email").on("click",function(){var a=$(this),b=a.attr("data-target-href");a=a.attr("data-index");a=$('.user-email[data-index="'+a+'"]').text();$.ajax({type:"POST",url:b,data:{email:a}}).done(function(c){if(c.status=="OK"){$(".user-email").last().parent().remove();$("#notifications").html('<p class="alert alert-success">Se ha desasociado la cuenta de correo.</p>')}c.status=="error"&&
$("#notifications").html('<p class="alert alert-error">'+c.message+"</p>");setLastEmailIndex()})})}
$(document).ajaxSend(function(a,b,c){function e(d){var h=null;if(document.cookie&&document.cookie!=="")for(var g=document.cookie.split(";"),i=0;i<g.length;i++){var j=jQuery.trim(g[i]);if(j.substring(0,d.length+1)==d+"="){h=decodeURIComponent(j.substring(d.length+1));break}}return h}function f(d){var h="//"+document.location.host,g=document.location.protocol+h;return d==g||d.slice(0,g.length+1)==g+"/"||d==h||d.slice(0,h.length+1)==h+"/"||!/^(\/\/|http:|https:).*/.test(d)}!/^(GET|HEAD|OPTIONS|TRACE)$/.test(c.type)&&
f(c.url)&&b.setRequestHeader("X-CSRFToken",e("csrftoken"))});jQuery.fn.shakeIt=function(a){a=jQuery.extend({speed:40,duration:400,spread:20},a);return this.each(function(){var b=jQuery(this),c=(a.spread-1)/2,e=function(){b.css("left",Math.floor(Math.random()*a.spread)-c+"px")};(function(){b.css("position","relative");var f=setInterval(e,a.speed);setTimeout(function(){clearInterval(f);b.css({position:"static"})},a.duration)})()})};
